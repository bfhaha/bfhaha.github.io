<html>

<head>

<title>建立測試用的網頁伺服器（支援MySQL）</title>
<meta name="description" content="建立測試用的網頁伺服器（支援MySQL）">

</head>

<body>




<h1>建立測試用的網頁伺服器（支援MySQL）</h1>


<!---------------------------------->
<!---------------------------------->
<!---------------------------------->

<h2>網頁伺服器</h2>

<p>在我們上傳網站到免費空間之前（例如<a href="https://www.000webhost.com/">000webhost</a>），我們會需要做一些測試，因為如果每修改一次就重新上傳一次很沒有效率。本文介紹一個很簡單、很小、免安裝的網頁伺服器架設軟體，<a href="http://www.uniformserver.com/">Uniform Server</a>。
</p>

<ul>

<li>到官網<a href="http://www.uniformserver.com/">http://www.uniformserver.com/</a>下載。
<br><img width="70%" src="img/web_server/webserver_01.jpg">
</li>

<li>下載之後解壓縮，得到一個資料夾UniServerZ。
<br><img width="70%" src="img/web_server/webserver_02.jpg">
</li>

<li>執行這個資料夾中的UniController.exe即可開啟。
<br><img width="70%" src="img/web_server/webserver_03.jpg">
</li>

<li>第一次執行時會要你設定從取根目錄的密碼，<font color="red">還要開啟防火牆</font>。
<br><img width="70%" src="img/web_server/webserver_04.jpg">
</li>

<li>介面真的很簡單。
<br><img width="70%" src="img/web_server/webserver_05.jpg">
</li>

<li>啟動伺服器之前，我們先回到UniServerZ資料夾中，進入其中的一個www資料夾。
<br><img width="70%" src="img/web_server/webserver_06.jpg">
</li>

<li>用記事本開啟其中的.htaccess檔案。
<br><img width="70%" src="img/web_server/webserver_07.jpg">
</li>

<li>把Deny from all改成Allow from IP，IP就輸入你要連到這個網頁的電腦IP。<font color="red">請勿使用Allow from all，你的電腦非常有可能會被入侵，或是被勒索，就是會把你的檔案全部加密無法打開，你必須要付費給他才幫你解。</font>
<br><img width="70%" src="img/web_server/webserver_08.jpg">
</li>

<li>接著回到程式點選[Start Apache]即可開啟伺服器。
<br><img width="70%" src="img/web_server/webserver_09.jpg">
</li>

<li>如果無法啟動，顯示"應用程式無法正確啟動 (0xc000007b)"，可以參考<a href="https://snippetinfo.net/media/1870">這篇文章</a>來解決。
</li>

<li>可以看到綠燈亮了表示伺服器正在運行中。
<br><img width="70%" src="img/web_server/webserver_10.jpg">
</li>

<li>外部要連線進來的話就在瀏覽器輸入http://伺服器的IP即可連線，注意到http後面並沒有s。（要知道伺服器IP的話可以到[命令提示字元]輸入ipconfig查詢。）
</li>

<li>我們現在說明如何建立一個有SSL的連線。<font color="red">注意，要先停止伺服器的運行才能設定，也就是要先按[Stop Apache]停止伺服器運行。</font>
</li>

<li>在程式首頁的功能表依序選擇[Apache]，[Apache SSL]，[Server Certificate and Key generator]
<br><img width="70%" src="img/web_server/webserver_11.jpg">
</li>

<li>選項都照預設的就好，按下[Generate]
<br><img width="70%" src="img/web_server/webserver_12.jpg">
</li>

<li>回到UniServerZ資料夾，這次要改成進入ssl資料夾中，跟剛剛一樣地，用記事本開啟.htaccess檔案，把Deny from all改成Allow from IP，IP就輸入你要連到這個網頁的電腦IP。<font color="red">請勿使用Allow from all，你的電腦非常有可能會被入侵，或是被勒索，就是會把你的檔案全部加密無法打開，你必須要付費給他才幫你解。</font>
</li>

<li>這時候從外部連線進來的時候，在瀏覽器輸入https://伺服器的IP，就是有SSL的連線。
</li>

<li>所以簡單來說，<br>http://伺服器的IP是連到UniServerZ/www/index.php<br>https://伺服器的IP是連到UniServerZ/ssl/index.php
</li>

</ul>


<!---------------------------------->
<!---------------------------------->
<!---------------------------------->

<h2>資料庫</h2>

<p>接下來我們設定資料庫</p>

<ul>

<li>關於PHP及MySQL的教學可以參考<a href="https://www.w3schools.com/">w3school</a>，這些課程很基本也很簡單。
</li>

<li>一樣在Uniform Server的主畫面按下[Start MySQL]，綠燈亮起表示開啟資料庫成功。
<br><img width="70%" src="img/web_server/webserver_13.jpg">
</li>

<li>按下[phpMyAdmin]會開啟網頁進到資料庫管理的頁面。
<br><img width="70%" src="img/web_server/webserver_14.jpg">
</li>

<li>在這個資料庫管理的頁面，選擇[Databases]。
<br><img width="70%" src="img/web_server/webserver_15.jpg">
</li>

<li>我們建立一個簡單的資料庫。輸入資料庫的名稱，例如mydb然後按下Create。
<br><img width="70%" src="img/web_server/webserver_16.jpg">
</li>

<li>接著建立一個簡單的工作表。輸入工作表的名稱，例如mytable，我們只要3個column，分別記錄Name, ID, Phone，然後按下Go。
<br><img width="70%" src="img/web_server/webserver_17.jpg">
</li>

<li>在Name的部分輸入各column的名稱：Name, ID, Phone，Type都選text。
<br><img width="70%" src="img/web_server/webserver_18.jpg">
</li>

<li>切換到[Structure]頁面，可以看到剛剛建立的三個column。在這裡也可以新增或移除column。
<br><img width="70%" src="img/web_server/webserver_19.jpg">
</li>

<li>切換到[Browse]頁面，目前尚未有資料。
<br><img width="70%" src="img/web_server/webserver_20.jpg">
</li>

<li>回到UniServerZ\www資料夾中，把原本的index.php備份起來（例如改個檔名），然後自己新增一個index.php，內容如下（用記事本編輯另存成index.php檔即可，記得存檔類型要選擇所有檔案。）<br>
&lt;html&gt;<br>
&lt;body&gt;<br>
<br>
&lt;form action=&quot;&quot; method=&quot;POST&quot;&gt;<br>
Name:  &lt;input type=&quot;text&quot; name=&quot;name&quot;&gt;  &lt;br&gt;<br>
ID:    &lt;input type=&quot;text&quot; name=&quot;id&quot;&gt;    &lt;br&gt;<br>
Phone: &lt;input type=&quot;text&quot; name=&quot;phone&quot;&gt; &lt;br&gt;<br>
&lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt;<br>
&lt;/form&gt;<br>
<br>
&lt;?php<br>
<br>
$link = mysqli_connect('127.0.0.1', 'root', '剛剛設定的密碼');<br>
<br>
if ( $_SERVER['REQUEST_METHOD'] === 'POST' )<br>
{<br>
<br>
$Name = $_POST[&quot;name&quot;];<br>
$ID = $_POST[&quot;id&quot;];<br>
$Phone = $_POST[&quot;phone&quot;];<br>
<br>
$sql = &quot;INSERT INTO mytable&quot;.<br>
       &quot;(Name,ID,Phone)&quot;.<br>
       &quot;VALUES&quot;.<br>
       &quot;('$Name','$ID','$Phone')&quot;; <br>
mysqli_select_db( $link, 'mydb' );<br>
mysqli_query( $link, $sql );<br>
<br>
}<br>
<br>
?&gt;<br>
<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>
</li>

<li>應該蠻好理解的，
    <ul>
    <li>第一個部分form就是建立一個填入個人資料的表單。</li>
    <li>第二個部分部分就是跟資料庫連線，127.0.0.1是本地IP，就是自己連線到自己，root是資料庫預設的帳號。</li>
    <li>if($_SERVER...這段是避免重新整理頁面時重新送出表格。</li>
    <li>$Name = $_POST["name"];是取得表格中輸入的資料。</li>
    <li>$sql = "INSERT INTO ...這裡是把輸入的資料存入資料庫。</li>
    </ul>
</li>

<li>如果無法順利執行，建議逐行執行看看，並在中間加入echo &quot;blabla&quot;，來確認是否順利執行至此。<a href="http://www.runoob.com/">這個網頁</a>的教學也不錯，範例都有加入判斷是否能夠順利執行的回報。
</li>

<li>或是到UniServerZ\core\apache2\logs裡面有個error檔，用記事本打開後可以看到錯誤訊息的記錄，<font color="red">例如我之前學的是用mysql_connect（沒有i），但這個指令在新版本的php已經不支援了</font>，<a href="https://www.php.net/manual/en/function.mysql-connect.php">參考這裡</a>，所以我執行mysql_connect(blabla)之後發現無法連上，在這個error檔案中就可以看到Fatal error: Call to undefined function mysql_connect()這個錯誤訊息。
</li>

<li>現在在客戶端的網頁瀏覽器輸入http://IP/index.php，IP就是伺服器的IP，可以在[命令提示字元]中輸入ipconfig查詢到，可以看到剛剛建立的表格，輸入個人資料後按下submit。
<br><img width="70%" src="img/web_server/webserver_21.jpg">
</li>

<li>回到資料庫的管理系統，可以看到已經收到剛剛由表格送出的個人資料，並建立成一筆新的資料了。
<br><img width="70%" src="img/web_server/webserver_22.jpg">
</li>

</ul>


</body>
</html>