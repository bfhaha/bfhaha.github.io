<html>

<head>

<title>根據網頁的h2, h3標題自動產生目錄</title>
<meta name="description" content="根據網頁的h2, h3標題自動產生目錄">

<style>
code, pre {background-color: lightgray;}
</style>

</head>

<body>

<h1>根據網頁的h2, h3標題自動產生目錄</h1>

<p>如題，<a href="https://jsbin.com/zixomeyufo/edit?html,output">範例</a>。</p>

<pre>

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;body&gt;

&lt;p id="tableOfContents"&gt;&lt;/p&gt;

&lt;h2&gt;Chapter&lt;/h2&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt;
  &lt;h3&gt;Section&lt;/h3&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt;
  &lt;h3&gt;Section&lt;/h3&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt;

&lt;h2&gt;Chapter&lt;/h2&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt;
  &lt;h3&gt;Section&lt;/h3&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt;
  &lt;h3&gt;Section&lt;/h3&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt;


&lt;script&gt;

var allTitles = document.querySelectorAll("H2, H3");
var numberOfTitles = allTitles.length;
var toc = "";

for(t=0, c=0, s=0; t &lt; numberOfTitles; t++)
{ 
  if(allTitles[t].nodeName == "H2")
  { 
    c++;
    allTitles[t].setAttribute("id", "chapter" + c);
    s=0;
    toc += "&lt;a href=#chapter" + c + "&gt;";
    toc += c + ". " + allTitles[t].innerHTML;
    toc += "&lt;/a&gt;";
    toc += "&lt;br&gt;";
  }
  
  if(allTitles[t].nodeName == "H3")
  {
    s++;
    allTitles[t].setAttribute("id", "section" + c + "." + s);
    toc += "&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=#section" + c + "." + s + "&gt;";
    toc += c + "." + s + ". " + allTitles[t].innerHTML;
    toc += "&lt;/a&gt;";
    toc += "&lt;br&gt;";
  }
}

document.getElementById("tableOfContents").innerHTML = toc;

&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>



</body>
</html>