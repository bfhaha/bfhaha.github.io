<html>

<head>

<title>根據巢狀階層項目自動產生網頁文章的目錄</title>
<meta name="description" content="根據巢狀階層項目自動產生網頁文章的目錄">

<style>
code, pre {background-color: lightgray;}
</style>

</head>

<body>

<h1>根據巢狀階層項目自動產生網頁文章的目錄（單階層）</h1>

<p>如果你用HTML寫了一個網頁，
裡面有用list寫成的項目，
也就是<br>
&lt;ol&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;&nbsp;&nbsp;&lt;/li&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;&nbsp;&nbsp;&lt;/li&gt;<br />
&lt;/ol&gt;<br />
下面這個JavaScript的程式碼可以替這些項目自動產生目錄。</p>

<pre>
&lt;html&gt;

&lt;body&gt;

&lt;h1&gt;Contents&lt;/h1&gt;
&lt;p id="contents"&gt;&lt;/p&gt;

&lt;h1&gt;Context&lt;/h1&gt;

&lt;ol&gt;
  
&lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
&lt;li class="first"&gt;Chapter&lt;/li&gt;

&lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
&lt;li class="first"&gt;Chapter&lt;/li&gt;

&lt;/ol&gt;

&lt;script&gt;
//get all the first order title
var f = document.getElementsByClassName("first");
//the total number of first order title
var numberOF = f.length;
//index for the loop
var i, j, k;
//give each title an id such that they can be linked
for(i=0; i&lt;numberOF; i++)
{
  f[i].setAttribute("id", "f" + i);
}
//generate the contents
var contents = "";
for(i=0; i&lt;numberOF; i++)
{
  contents += "&lt;a href=#f" + i + "&gt;";
  contents += (i+1)+". ";
  contents += f[i].childNodes[0].nodeValue;
  contents += "&lt;/a&gt;";
  contents += "&lt;br&gt;&lt;br&gt;";
}
//show the contents
document.getElementById("contents").innerHTML = contents;
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt; 
</pre>


<h1>根據巢狀階層項目自動產生網頁文章的目錄（多階層）</h1>

<p>如果是多階層的項目，
也就是<br />
&lt;ul&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&lt;/li&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&lt;/li&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br />
&nbsp;&nbsp;&nbsp;&lt;/li&gt;<br />
&lt;/ul&gt;<br />
則可以用下面的程式碼。</p>

<pre>
&lt;html&gt;
&lt;head&gt;

&lt;style&gt;
.first{color:red; font-weight: bold;}
.second{color:orange; font-weight: bold;}
.third{color:green; font-weight: bold;}

.forth{color:black; font-weight: normal;}
&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;h1&gt;An Article with Contents&lt;/h1&gt;

&lt;h2&gt;Contents&lt;/h2&gt;
&lt;p id="contents"&gt;&lt;/p&gt;

&lt;h2&gt;Context&lt;/h2&gt;

&lt;ol&gt;
&lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
&lt;li class="first"&gt;Chapter
  &lt;ol&gt;
  &lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
  &lt;li class="second"&gt;Section
    &lt;ol&gt;
    &lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
    &lt;li class="third"&gt;Subsection
      &lt;p class="forth"&gt;bla bla bla bla&lt;/p&gt;
    &lt;/li&gt;

    &lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
    &lt;li class="third"&gt;Subsection
      &lt;ul&gt;
      &lt;li class="forth"&gt;item&lt;/li&gt;
      &lt;li class="forth"&gt;item&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
  &lt;li class="second"&gt;Section
    &lt;ol&gt;
    &lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
    &lt;li class="third"&gt;Subsection
    &lt;/li&gt;

    &lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
    &lt;li class="third"&gt;Subsection
    &lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;/ol&gt;
&lt;/li&gt;

&lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
&lt;li class="first"&gt;Chapter
  &lt;ol&gt;
  &lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
  &lt;li class="second"&gt;Section
    &lt;ol&gt;
    &lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
    &lt;li class="third"&gt;Subsection
    &lt;/li&gt;

    &lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
    &lt;li class="third"&gt;Subsection
    &lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
  &lt;li class="second"&gt;Section
    &lt;ol&gt;
    &lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
    &lt;li class="third"&gt;Subsection
    &lt;/li&gt;

    &lt;!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%--&gt;
    &lt;li class="third"&gt;Subsection
    &lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;/ol&gt;
&lt;/li&gt;

&lt;/ol&gt;


&lt;script&gt;
//get all the first order title
var f = document.getElementsByClassName("first");

//the total number of first order title
var numberOF = f.length;

//index for the loop
var i, j, k;

//give each title an id such that they can be linked
for(i=0; i&lt;numberOF; i++)
{
  f[i].setAttribute("id", "f" + i);

  //second order title within current first order title
  var s = f[i].getElementsByClassName("second");
  var numberOSinF = s.length;

  for(j=0; j&lt;numberOSinF; j++)
  {
    s[j].setAttribute("id", "f" + i + "s" + j);
    
    //third order title within current second order title
    var t = s[j].getElementsByClassName("third");
    var numberOTinS = t.length;

    for(k=0; k&lt;numberOTinS; k++)
    {
      t[k].setAttribute("id", "f" + i + "s" + j + "t" + k);
    }
  }
}

//generate the contents
var contents = "";

for(i=0; i&lt;numberOF; i++)
{
  contents += "&lt;a href=#f" + i + "&gt;";
  contents += f[i].childNodes[0].nodeValue;
  contents += "&lt;/a&gt;";
  contents += "&lt;br&gt;";

  var s = f[i].getElementsByClassName("second");
  var numberOSinF = s.length;

  for(j=0; j&lt;numberOSinF; j++)
  {
    contents += "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp";
    contents += "&lt;a href=#f" + i + "s" + j + "&gt;";
    contents += s[j].childNodes[0].nodeValue;
    contents += "&lt;/a&gt;";
    contents += "&lt;br&gt;";
    
    var t = s[j].getElementsByClassName("third");
    var numberOTinS = t.length;

    for(k=0; k&lt;numberOTinS; k++)
    {
      contents += "&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp";
      contents += "&lt;a href=#f" + i + "s" + j + "t" + k + "&gt;";
      contents += t[k].childNodes[0].nodeValue;
      contents += "&lt;/a&gt;";
      contents += "&lt;br&gt;";
    }
  }
}

//show the contents
document.getElementById("contents").innerHTML = contents;

&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>

<p><font color="red">上面的方法中，也可以不要用class，然後用first=getElementsByTagName("ul")及first.getElementsByTagName("li")。</font></p>

<p>注意到上面的方法不能用在建立以&lt;h2&gt;&lt;/h2&gt;&lt;h3&gt;&lt;/h3&gt;為標題的目錄，
這個情形之下，
使用<a href="https://bfhaha.github.io/generate-toc-h2.html">這個方法</a>。
</p>

</body>
</html>